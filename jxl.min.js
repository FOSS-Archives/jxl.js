!function(){function e(e,t){var a=document.createElement("canvas");a.width=t.width,a.height=t.height,a.getContext("2d").putImageData(t,0,0),e.style.backgroundImage='url("'+a.toDataURL()+'")'}async function t(e,t){let a=document.createElement("canvas");a.width=1===e.width?t.width:e.width,a.height=1===e.height?t.height:e.height,a.className=e.className,a.id=e.id,a.dataset.jxlSrc=e.dataset.jxlSrc;let i=await window.createImageBitmap(t,{resizeWidth:a.width,resizeHeight:a.height});a.getContext("2d").drawImage(i,0,0),e.replaceWith(a)}async function a(a,i){let h=a.dataset.jxlSrc=i?getComputedStyle(a).backgroundImage.slice(5,-2):a.currentSrc;a.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";let n=await caches.open("jxl"),r=await n.match(h);if(r){let d=new ImageData(new Uint8ClampedArray(await r.arrayBuffer()),r.headers.get("width"),r.headers.get("height"));i?e(a,d):t(a,d);return}let s=await fetch(h),c=await s.arrayBuffer(),l=new Worker("jxl_dec.js");l.postMessage({jxlSrc:h,image:c}),l.addEventListener("message",r=>{let d=r.data.result;i?e(a,d):t(a,d),n.put(h,new Response(d.data,{headers:{"content-type":"image/jxl",width:d.width,height:d.height}}))})}new MutationObserver(e=>{e.forEach(e=>{Array.prototype.filter.call(e.addedNodes,e=>e instanceof HTMLImageElement&&e.src.endsWith(".jxl")||e instanceof Element&&getComputedStyle(e).backgroundImage.endsWith('.jxl")')).forEach(e=>{e instanceof HTMLImageElement?e.onerror=()=>a(e,!1):a(e,!0)})})}).observe(document.documentElement,{subtree:!0,childList:!0})}();