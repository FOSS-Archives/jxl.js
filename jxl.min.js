!function(){"use strict";let e={useCache:!0},a,t={};function s(s,c,n){let r=s.dataset.jxlSrc;if(c instanceof Blob){let l=URL.createObjectURL(c);n?s.style.backgroundImage='url("'+l+'")':s.src=l}else if("OffscreenCanvas"in window){let i=new OffscreenCanvas(c.width,c.height);t[r].postMessage({canvas:i,imgData:c},[i]),t[r].addEventListener("message",t=>{t.data.url&&t.data.blob&&(n?s.style.backgroundImage='url("'+t.data.url+'")':s.src=t.data.url,e.useCache&&a&&a.put(r,new Response(t.data.blob)))})}else{let d=document.createElement("canvas");d.width=c.width,d.height=c.height,d.getContext("2d").putImageData(c,0,0),d.toBlob(async t=>{let c=URL.createObjectURL(t);n?s.style.backgroundImage='url("'+c+'")':s.src=c,e.useCache&&a&&a.put(r,new Response(t))},"image/jpeg")}}async function c(c,n){let r=c.dataset.jxlSrc=n?getComputedStyle(c).backgroundImage.slice(5,-2):c.currentSrc;if(c.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",e.useCache){try{a=a||await caches.open("jxl")}catch(l){}let i=a&&await a.match(r);if(i){let d=await i.blob();requestAnimationFrame(()=>s(c,d,n));return}}let o=await fetch(r),u=await o.arrayBuffer();t[r]=new Worker("jxl_dec.js"),t[r].postMessage({jxlSrc:r,image:u}),t[r].addEventListener("message",e=>e.data.imgData&&requestAnimationFrame(()=>s(c,e.data.imgData,n)))}new MutationObserver(e=>e.forEach(e=>Array.prototype.filter.call(e.addedNodes,e=>e instanceof HTMLImageElement&&e.src.endsWith(".jxl")||e instanceof Element&&getComputedStyle(e).backgroundImage.endsWith('.jxl")')).forEach(e=>{e instanceof HTMLImageElement?e.onerror=()=>c(e,!1):c(e,!0)}))).observe(document.documentElement,{subtree:!0,childList:!0})}();