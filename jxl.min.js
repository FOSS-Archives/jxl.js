!function(){let e;function t(e,t){var a=document.createElement("canvas");a.width=t.width,a.height=t.height,a.getContext("2d").putImageData(t,0,0),e.style.backgroundImage='url("'+a.toDataURL()+'")'}async function a(e,t){let a=document.createElement("canvas");a.width=1===e.width?t.width:e.width,a.height=1===e.height?t.height:e.height,a.className=e.className,a.id=e.id,a.title=e.title,a.dataset.jxlSrc=e.dataset.jxlSrc;let i=await window.createImageBitmap(t,{resizeWidth:a.width,resizeHeight:a.height});a.getContext("2d").drawImage(i,0,0),e.replaceWith(a)}async function i(i,h){let r=h?getComputedStyle(i).backgroundImage.slice(5,-2):i.dataset.jxlSrc=i.currentSrc;i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";try{e=await caches.open("jxl")}catch(n){}let d=e&&await e.match(r);if(d){let c=new ImageData(new Uint8ClampedArray(await d.arrayBuffer()),d.headers.get("width"),d.headers.get("height"));requestAnimationFrame(()=>h?t(i,c):a(i,c));return}let s=await fetch(r),l=await s.arrayBuffer(),g=new Worker("jxl_dec.js");g.postMessage({jxlSrc:r,image:l}),g.addEventListener("message",n=>{let d=n.data.result;requestAnimationFrame(()=>h?t(i,d):a(i,d)),e&&e.put(r,new Response(d.data,{headers:{"content-type":"image/jxl",width:d.width,height:d.height}}))})}new MutationObserver(e=>{e.forEach(e=>{Array.prototype.filter.call(e.addedNodes,e=>e instanceof HTMLImageElement&&e.src.endsWith(".jxl")||e instanceof Element&&getComputedStyle(e).backgroundImage.endsWith('.jxl")')).forEach(e=>{e instanceof HTMLImageElement?e.onerror=()=>i(e,!1):i(e,!0)})})}).observe(document.documentElement,{subtree:!0,childList:!0})}();